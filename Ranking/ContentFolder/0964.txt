<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Needham–Schroeder protocol - Wikipedia</title>
<script>document.documentElement.className="client-js";RLCONF={"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Needham–Schroeder_protocol","wgTitle":"Needham–Schroeder protocol","wgCurRevisionId":886382140,"wgRevisionId":886382140,"wgArticleId":432989,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Commons category link from Wikidata","CS1 maint: uses authors parameter","Authentication protocols","Key transport protocols","Symmetric-key cryptography","Computer access control protocols"],"wgBreakFrames":!1,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct",
"Nov","Dec"],"wgRelevantPageName":"Needham–Schroeder_protocol","wgRelevantArticleId":432989,"wgRequestId":"XYt1RApAAEMAAIYxidkAAAAR","wgCSPNonce":!1,"wgIsProbablyEditable":!0,"wgRelevantPageIsProbablyEditable":!0,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgMediaViewerOnClick":!0,"wgMediaViewerEnabledByDefault":!0,"wgPopupsReferencePreviews":!1,"wgPopupsConflictsWithNavPopupGadget":!1,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgMFDisplayWikibaseDescriptions":{"search":!0,"nearby":!0,"watchlist":!0,"tagline":!1},"wgWMESchemaEditAttemptStepOversample":!1,"wgPoweredByHHVM":!1,"wgULSCurrentAutonym":"English","wgNoticeProject":"wikipedia","wgWikibaseItemId":"Q934370","wgCentralAuthMobileDomain":!1,"wgEditSubmitButtonLabelPublish":!0};RLSTATE={"ext.globalCssJs.user.styles":"ready","site.styles":"ready","noscript":"ready","user.styles":"ready","ext.globalCssJs.user":"ready","user":"ready",
"user.options":"ready","user.tokens":"loading","ext.cite.styles":"ready","ext.math.styles":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.toc.styles":"ready","wikibase.client.init":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.uls.interlanguage":"ready","ext.wikimediaBadges":"ready","ext.3d.styles":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"};RLPAGEMODULES=["ext.cite.ux-enhancements","ext.math.scripts","site","mediawiki.page.startup","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","ext.gadget.teahouse","ext.gadget.ReferenceTooltips","ext.gadget.watchlist-notice","ext.gadget.DRN-wizard","ext.gadget.charinsert","ext.gadget.refToolbar","ext.gadget.extra-toolbar-buttons","ext.gadget.switcher","ext.centralauth.centralautologin","mmv.head","mmv.bootstrap.autostart","ext.popups","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","ext.eventLogging",
"ext.wikimediaEvents","ext.navigationTiming","ext.uls.compactlinks","ext.uls.interface","ext.cx.eventlogging.campaigns","ext.quicksurveys.init","ext.centralNotice.geoIP","ext.centralNotice.startUp","skins.vector.js"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.tokens@tffin",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=ext.3d.styles%7Cext.cite.styles%7Cext.math.styles%7Cext.uls.interlanguage%7Cext.visualEditor.desktopArticleTarget.noscript%7Cext.wikimediaBadges%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.interface%7Cmediawiki.toc.styles%7Cskins.vector.styles%7Cwikibase.client.init&amp;only=styles&amp;skin=vector"/>
<script async="" src="/w/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.34.0-wmf.23"/>
<meta name="referrer" content="origin"/>
<meta name="referrer" content="origin-when-crossorigin"/>
<meta name="referrer" content="origin-when-cross-origin"/>
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4b/Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg/1200px-Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg.png"/>
<link rel="alternate" href="android-app://org.wikipedia/http/en.m.wikipedia.org/wiki/Needham%E2%80%93Schroeder_protocol"/>
<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit"/>
<link rel="edit" title="Edit this page" href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit"/>
<link rel="apple-touch-icon" href="/static/apple-touch/wikipedia.png"/>
<link rel="shortcut icon" href="/static/favicon/wikipedia.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="//en.wikipedia.org/w/api.php?action=rsd"/>
<link rel="license" href="//creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="canonical" href="https://en.wikipedia.org/wiki/Needham%E2%80%93Schroeder_protocol"/>
<link rel="dns-prefetch" href="//login.wikimedia.org"/>
<link rel="dns-prefetch" href="//meta.wikimedia.org" />
<!--[if lt IE 9]><script src="/w/resources/lib/html5shiv/html5shiv.js"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject mw-editable page-Needham–Schroeder_protocol rootpage-Needham–Schroeder_protocol skin-vector action-view">
<div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"><!-- CentralNotice --></div>
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">Needham–Schroeder protocol</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From Wikipedia, the free encyclopedia</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div class="thumb tright"><div class="thumbinner" style="width:292px;"><a href="/wiki/File:Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg" class="image"><img alt="" src="//upload.wikimedia.org/wikipedia/commons/thumb/4/4b/Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg/290px-Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg.png" decoding="async" width="290" height="410" class="thumbimage" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/4/4b/Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg/435px-Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/4/4b/Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg/580px-Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg.png 2x" data-file-width="1052" data-file-height="1488" /></a>  <div class="thumbcaption"><div class="magnify"><a href="/wiki/File:Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg" class="internal" title="Enlarge"></a></div>Symmetric Needham–Schroeder protocol scheme</div></div></div>
<p>The <b>Needham–Schroeder protocol</b> is one of the two key transport protocols intended for use over an insecure network, both proposed by <a href="/wiki/Roger_Needham" title="Roger Needham">Roger Needham</a> and <a href="/wiki/Michael_Schroeder" title="Michael Schroeder">Michael Schroeder</a>.<sup id="cite_ref-needham-schroeder_1-0" class="reference"><a href="#cite_note-needham-schroeder-1">&#91;1&#93;</a></sup> These are:
</p>
<ul><li>The <i>Needham–Schroeder Symmetric Key Protocol</i>, based on a <a href="/wiki/Symmetric-key_algorithm" title="Symmetric-key algorithm">symmetric encryption algorithm</a>. It forms the basis for the <a href="/wiki/Kerberos_(protocol)" title="Kerberos (protocol)">Kerberos</a> protocol. This protocol aims to establish a <a href="/wiki/Session_key" title="Session key">session key</a> between two parties on a network, typically to protect further communication.</li>
<li>The <i>Needham–Schroeder Public-Key Protocol</i>, based on <a href="/wiki/Public-key_cryptography" title="Public-key cryptography">public-key cryptography</a>. This protocol is intended to provide mutual <a href="/wiki/Authentication" title="Authentication">authentication</a> between two parties communicating on a network, but in its proposed form is insecure.</li></ul>
<div id="toc" class="toc"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#The_symmetric_protocol"><span class="tocnumber">1</span> <span class="toctext">The symmetric protocol</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Attacks_on_the_protocol"><span class="tocnumber">1.1</span> <span class="toctext">Attacks on the protocol</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Fixing_the_attack"><span class="tocnumber">1.2</span> <span class="toctext">Fixing the attack</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#The_public-key_protocol"><span class="tocnumber">2</span> <span class="toctext">The public-key protocol</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#An_attack_on_the_protocol"><span class="tocnumber">2.1</span> <span class="toctext">An attack on the protocol</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Fixing_the_man-in-the-middle_attack"><span class="tocnumber">2.2</span> <span class="toctext">Fixing the man-in-the-middle attack</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#See_also"><span class="tocnumber">3</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#References"><span class="tocnumber">4</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#External_links"><span class="tocnumber">5</span> <span class="toctext">External links</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="The_symmetric_protocol">The symmetric protocol</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit&amp;section=1" title="Edit section: The symmetric protocol">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Here, <a href="/wiki/Alice_and_Bob" title="Alice and Bob">Alice</a> (A) initiates the communication to Bob (B). S is a server trusted by both parties. In the communication:
</p>
<ul><li>A and B are identities of Alice and Bob respectively</li>
<li>K<sub>AS</sub> is a symmetric key known only to A and S</li>
<li>K<sub>BS</sub> is a symmetric key known only to B and S</li>
<li>N<sub>A</sub> and N<sub>B</sub> are <a href="/wiki/Cryptographic_nonce" title="Cryptographic nonce">nonces</a> generated by A and B respectively</li>
<li>K<sub>AB</sub> is a symmetric, generated key, which will be the <a href="/wiki/Session_key" title="Session key">session key</a> of the session between A and B</li></ul>
<p>The protocol can be specified as follows in <a href="/wiki/Security_protocol_notation" title="Security protocol notation">security protocol notation</a>:
</p><p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\rightarrow S:\left.A,B,N_{A}\right.}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>S</mi>
        <mo>:</mo>
        <mrow>
          <mo fence="true" stretchy="true" symmetric="true"></mo>
          <mrow>
            <mi>A</mi>
            <mo>,</mo>
            <mi>B</mi>
            <mo>,</mo>
            <msub>
              <mi>N</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>A</mi>
              </mrow>
            </msub>
          </mrow>
          <mo fence="true" stretchy="true" symmetric="true"></mo>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\rightarrow S:\left.A,B,N_{A}\right.}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5157688443f4fe0aba730383b94519a20c67b16d" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:17.7ex; height:2.509ex;" alt="A\rightarrow S:\left.A,B,N_{A}\right."/></span>
</p>
<dl><dd>Alice sends a message to the server identifying herself and Bob, telling the server she wants to communicate with Bob.</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle S\rightarrow A:\{N_{A},K_{AB},B,\{K_{AB},A\}_{K_{BS}}\}_{K_{AS}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>S</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>A</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>B</mi>
        <mo>,</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>A</mi>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>B</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>A</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle S\rightarrow A:\{N_{A},K_{AB},B,\{K_{AB},A\}_{K_{BS}}\}_{K_{AS}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0de4ed56a20adf61221795d448ad6d452b8fd9b3" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:41.106ex; height:3.009ex;" alt="S\rightarrow A:\{N_{A},K_{{AB}},B,\{K_{{AB}},A\}_{{K_{{BS}}}}\}_{{K_{{AS}}}}"/></span>
</p>
<dl><dd>The server generates <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {K_{AB}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <msub>
            <mi>K</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mi>A</mi>
              <mi>B</mi>
            </mrow>
          </msub>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {K_{AB}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1908c0dade529f068ef533b252efe983e007e67b" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:4.685ex; height:2.509ex;" alt="{K_{{AB}}}"/></span> and sends back to Alice a copy encrypted under <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {K_{BS}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <msub>
            <mi>K</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mi>B</mi>
              <mi>S</mi>
            </mrow>
          </msub>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {K_{BS}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/820a9f6069f550a63a56bfe5267b89804ee4ee27" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:4.513ex; height:2.509ex;" alt="{K_{{BS}}}"/></span> for Alice to forward to Bob and also a copy for Alice. Since Alice may be requesting keys for several different people, the nonce assures Alice that the message is fresh and that the server is replying to that particular message and the inclusion of Bob's name tells Alice who she is to share this key with.</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\rightarrow B:\{K_{AB},A\}_{K_{BS}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>B</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>A</mi>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>B</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\rightarrow B:\{K_{AB},A\}_{K_{BS}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ee9352dea692f4be4aa48229f2a1d8be980f432a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:22.51ex; height:3.009ex;" alt="A\rightarrow B:\{K_{{AB}},A\}_{{K_{{BS}}}}"/></span>
</p>
<dl><dd>Alice forwards the key to Bob who can decrypt it with the key he shares with the server, thus authenticating the data.</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B\rightarrow A:\{N_{B}\}_{K_{AB}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>A</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>A</mi>
                <mi>B</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B\rightarrow A:\{N_{B}\}_{K_{AB}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bc158814bc2b8a16f7eaddcd00bf3ac3d85e709f" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:18.534ex; height:3.009ex;" alt="B\rightarrow A:\{N_{B}\}_{{K_{{AB}}}}"/></span>
</p>
<dl><dd>Bob sends Alice a nonce encrypted under <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {K_{AB}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <msub>
            <mi>K</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mi>A</mi>
              <mi>B</mi>
            </mrow>
          </msub>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {K_{AB}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1908c0dade529f068ef533b252efe983e007e67b" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:4.685ex; height:2.509ex;" alt="{K_{{AB}}}"/></span> to show that he has the key.</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\rightarrow B:\{N_{B}-1\}_{K_{AB}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>B</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>&#x2212;<!-- − --></mo>
        <mn>1</mn>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>A</mi>
                <mi>B</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\rightarrow B:\{N_{B}-1\}_{K_{AB}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9e29f80f8598183248eb4613b771aa6d193e4216" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:22.537ex; height:3.009ex;" alt="A\rightarrow B:\{N_{B}-1\}_{{K_{{AB}}}}"/></span>
</p>
<dl><dd>Alice performs a simple operation on the nonce, re-encrypts it and sends it back verifying that she is still alive and that she holds the key.</dd></dl>
<h3><span class="mw-headline" id="Attacks_on_the_protocol">Attacks on the protocol</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit&amp;section=2" title="Edit section: Attacks on the protocol">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The protocol is vulnerable to a <a href="/wiki/Replay_attack" title="Replay attack">replay attack</a> (as identified by <a href="/wiki/Dorothy_E._Denning" title="Dorothy E. Denning">Denning</a> and Sacco<sup id="cite_ref-2" class="reference"><a href="#cite_note-2">&#91;2&#93;</a></sup>). If an attacker uses an older, compromised value for K<sub>AB</sub>, he can then replay the message <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \{K_{AB},A\}_{K_{BS}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>A</mi>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>B</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \{K_{AB},A\}_{K_{BS}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e4ba6beb3b9746811ecfcb2eb35c69b74c629660" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:13.452ex; height:3.009ex;" alt="\{K_{{AB}},A\}_{{K_{{BS}}}}"/></span> to Bob, who will accept it, being unable to tell that the key is not fresh.
</p>
<h3><span class="mw-headline" id="Fixing_the_attack">Fixing the attack</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit&amp;section=3" title="Edit section: Fixing the attack">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This flaw is fixed in the <a href="/wiki/Kerberos_protocol" class="mw-redirect" title="Kerberos protocol">Kerberos protocol</a> by the inclusion of a <a href="/wiki/Timestamp" title="Timestamp">timestamp</a>. It can also be fixed with the  use of nonces as described below.<sup id="cite_ref-3" class="reference"><a href="#cite_note-3">&#91;3&#93;</a></sup> At the beginning of the protocol:
</p>
<dl><dd><dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\rightarrow B:A}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>B</mi>
        <mo>:</mo>
        <mi>A</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\rightarrow B:A}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/90dd96103728060dff197832e0b57c5e6fc9a9b5" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:10.801ex; height:2.176ex;" alt="A\rightarrow B:A"/></span></dd></dl></dd></dl>
<dl><dd>Alice sends to Bob a request.</dd></dl>
<dl><dd><dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B\rightarrow A:\{A,\mathbf {N_{B}'} \}_{K_{BS}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>A</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <mi>A</mi>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <msubsup>
            <mi mathvariant="bold">N</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">B</mi>
            </mrow>
            <mo>&#x2032;</mo>
          </msubsup>
        </mrow>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>B</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B\rightarrow A:\{A,\mathbf {N_{B}'} \}_{K_{BS}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cf3d60f92da9878ac391c44f64da83f8e36767d0" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:21.493ex; height:3.009ex;" alt="B\rightarrow A:\{A,{\mathbf  {N_{B}&#039;}}\}_{{K_{{BS}}}}"/></span></dd></dl></dd></dl>
<dl><dd>Bob responds with a nonce encrypted under his key with the Server.</dd></dl>
<dl><dd><dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\rightarrow S:\left.A,B,N_{A},\{A,\mathbf {N_{B}'} \}_{K_{BS}}\right.}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>S</mi>
        <mo>:</mo>
        <mrow>
          <mo fence="true" stretchy="true" symmetric="true"></mo>
          <mrow>
            <mi>A</mi>
            <mo>,</mo>
            <mi>B</mi>
            <mo>,</mo>
            <msub>
              <mi>N</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>A</mi>
              </mrow>
            </msub>
            <mo>,</mo>
            <mo fence="false" stretchy="false">{</mo>
            <mi>A</mi>
            <mo>,</mo>
            <mrow class="MJX-TeXAtom-ORD">
              <msubsup>
                <mi mathvariant="bold">N</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">B</mi>
                </mrow>
                <mo>&#x2032;</mo>
              </msubsup>
            </mrow>
            <msub>
              <mo fence="false" stretchy="false">}</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <msub>
                  <mi>K</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>B</mi>
                    <mi>S</mi>
                  </mrow>
                </msub>
              </mrow>
            </msub>
          </mrow>
          <mo fence="true" stretchy="true" symmetric="true"></mo>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\rightarrow S:\left.A,B,N_{A},\{A,\mathbf {N_{B}'} \}_{K_{BS}}\right.}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5d602b0eb41c7cf9020ca7d6c5067ead704057d8" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:31.168ex; height:3.009ex;" alt="A\rightarrow S:\left.A,B,N_{A},\{A,{\mathbf  {N_{B}&#039;}}\}_{{K_{{BS}}}}\right."/></span></dd></dl></dd></dl>
<dl><dd>Alice sends a message to the server identifying herself and Bob, telling the server she wants to communicate with Bob.</dd></dl>
<dl><dd><dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle S\rightarrow A:\{N_{A},K_{AB},B,\{K_{AB},A,\mathbf {N_{B}'} \}_{K_{BS}}\}_{K_{AS}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>S</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>A</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>B</mi>
        <mo>,</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>A</mi>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <msubsup>
            <mi mathvariant="bold">N</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">B</mi>
            </mrow>
            <mo>&#x2032;</mo>
          </msubsup>
        </mrow>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>B</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>A</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle S\rightarrow A:\{N_{A},K_{AB},B,\{K_{AB},A,\mathbf {N_{B}'} \}_{K_{BS}}\}_{K_{AS}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/95411bd7a726f471c5ba1a4a3c8120a0e69aaf47" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:45.808ex; height:3.009ex;" alt="S\rightarrow A:\{N_{A},K_{{AB}},B,\{K_{{AB}},A,{\mathbf  {N_{B}&#039;}}\}_{{K_{{BS}}}}\}_{{K_{{AS}}}}"/></span></dd></dl></dd></dl>
<dl><dd>Note the inclusion of the nonce.</dd></dl>
<p>The protocol then continues as described through the final three steps as described in the original protocol <a href="#The_symmetric_protocol">above</a>. Note that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle N_{B}'}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
          <mo>&#x2032;</mo>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle N_{B}'}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9d9a35e12ef2cd96ee163de45f59573a311d358a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:3.346ex; height:2.843ex;" alt="N_{B}&#039;"/></span> is a different nonce from <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle N_{B}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle N_{B}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cc141c4bf37d6a37464b3eabe8a30b2e1c9dbe29" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:3.346ex; height:2.509ex;" alt="N_{B}"/></span>.The inclusion of this new nonce  prevents the replaying of a compromised version of  <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \{K_{AB},A\}_{K_{BS}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>A</mi>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>B</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \{K_{AB},A\}_{K_{BS}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e4ba6beb3b9746811ecfcb2eb35c69b74c629660" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:13.452ex; height:3.009ex;" alt="\{K_{{AB}},A\}_{{K_{{BS}}}}"/></span> since such a message would need to be of the form <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \{K_{AB},A,\mathbf {N_{B}'} \}_{K_{BS}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>A</mi>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <msubsup>
            <mi mathvariant="bold">N</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">B</mi>
            </mrow>
            <mo>&#x2032;</mo>
          </msubsup>
        </mrow>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>B</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \{K_{AB},A,\mathbf {N_{B}'} \}_{K_{BS}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2d5ee18f79cecac610cac315b64bf9d1affafaf5" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:18.154ex; height:3.009ex;" alt="\{K_{{AB}},A,{\mathbf  {N_{B}&#039;}}\}_{{K_{{BS}}}}"/></span> which the attacker can't forge since she does not have <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle K_{BS}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
            <mi>S</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle K_{BS}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0ce1624269271c928441305442b593752812b225" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:4.513ex; height:2.509ex;" alt="K_{{BS}}"/></span>.
</p>
<h2><span class="mw-headline" id="The_public-key_protocol">The public-key protocol</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit&amp;section=4" title="Edit section: The public-key protocol">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This assumes the use of a <a href="/wiki/Public-key_cryptography" title="Public-key cryptography">public-key encryption algorithm</a>.
</p><p>Here, Alice (A) and Bob (B) use a trusted server (S) to distribute public keys on request. These keys are:
</p>
<ul><li>K<sub>PA</sub> and K<sub>SA</sub>, respectively public and private halves of an encryption key-pair belonging to A (S stands for "secret key" here)</li>
<li>K<sub>PB</sub> and K<sub>SB</sub>, similar belonging to B</li>
<li>K<sub>PS</sub> and K<sub>SS</sub>, similar belonging to S. (Note that this key-pair will be used for <a href="/wiki/Digital_signature" title="Digital signature">digital signatures</a>, i.e., K<sub>SS</sub> used for signing a message and K<sub>PS</sub> used for verification.  K<sub>PS</sub>  must be known to A and B before the protocol starts.)</li></ul>
<p>The protocol runs as follows:
</p><p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\rightarrow S:\left.A,B\right.}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>S</mi>
        <mo>:</mo>
        <mrow>
          <mo fence="true" stretchy="true" symmetric="true"></mo>
          <mrow>
            <mi>A</mi>
            <mo>,</mo>
            <mi>B</mi>
          </mrow>
          <mo fence="true" stretchy="true" symmetric="true"></mo>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\rightarrow S:\left.A,B\right.}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fb60adb876d985015106d289d3777a264669ca53" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:13.335ex; height:2.509ex;" alt="A\rightarrow S:\left.A,B\right."/></span>
</p>
<dl><dd>A requests B's public keys from S</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle S\rightarrow A:\{K_{PB},B\}_{K_{SS}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>S</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>A</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>P</mi>
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>B</mi>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>S</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle S\rightarrow A:\{K_{PB},B\}_{K_{SS}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/103f9d8a05513a90c30c5fc75dfa3acef0371660" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:22.116ex; height:3.009ex;" alt="S\rightarrow A:\{K_{{PB}},B\}_{{K_{{SS}}}}"/></span>
</p>
<dl><dd>S responds with public key K<sub>PB</sub> alongside B's identity, signed by the server for authentication purposes.</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\rightarrow B:\{N_{A},A\}_{K_{PB}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>B</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>A</mi>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>B</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\rightarrow B:\{N_{A},A\}_{K_{PB}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8a4e88c0eca26d384a9c833bbb351d59201c135f" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:21.298ex; height:3.009ex;" alt="A\rightarrow B:\{N_{A},A\}_{{K_{{PB}}}}"/></span>
</p>
<dl><dd>A chooses a random N<sub>A</sub> and sends it to B.</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B\rightarrow S:\left.B,A\right.}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>S</mi>
        <mo>:</mo>
        <mrow>
          <mo fence="true" stretchy="true" symmetric="true"></mo>
          <mrow>
            <mi>B</mi>
            <mo>,</mo>
            <mi>A</mi>
          </mrow>
          <mo fence="true" stretchy="true" symmetric="true"></mo>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B\rightarrow S:\left.B,A\right.}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/789963992e637c6636c559586ddd479b3c81be59" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; width:13.356ex; height:2.509ex;" alt="B\rightarrow S:\left.B,A\right."/></span>
</p>
<dl><dd>B now knows A wants to communicate, so B requests A's public keys.</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle S\rightarrow B:\{K_{PA},A\}_{K_{SS}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>S</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>B</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>K</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>P</mi>
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>A</mi>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>S</mi>
                <mi>S</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle S\rightarrow B:\{K_{PA},A\}_{K_{SS}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5a871f0298ef00f0c1b6e12a479949067c90b496" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:22.101ex; height:3.009ex;" alt="S\rightarrow B:\{K_{{PA}},A\}_{{K_{{SS}}}}"/></span>
</p>
<dl><dd>Server responds.</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B\rightarrow A:\{N_{A},N_{B}\}_{K_{PA}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>A</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>A</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B\rightarrow A:\{N_{A},N_{B}\}_{K_{PA}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c4ee5a341e29812b2db22630e400659365848ea4" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:22.888ex; height:3.009ex;" alt="B\rightarrow A:\{N_{A},N_{B}\}_{{K_{{PA}}}}"/></span>
</p>
<dl><dd>B chooses a random N<sub>B</sub>, and sends it to A along with N<sub>A</sub> to prove ability to decrypt with K<sub>SB</sub>.</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\rightarrow B:\{N_{B}\}_{K_{PB}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>B</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>B</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\rightarrow B:\{N_{B}\}_{K_{PB}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cf8b231a292ace4677daa3334cf2b61bcdcbced9" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:18.535ex; height:3.009ex;" alt="A\rightarrow B:\{N_{B}\}_{{K_{{PB}}}}"/></span>
</p>
<dl><dd>A confirms N<sub>B</sub> to B, to prove ability to decrypt with K<sub>SA</sub></dd></dl>
<p>At the end of the protocol, A and B know each other's identities, and know both N<sub>A</sub> and N<sub>B</sub>. These nonces are not known to eavesdroppers.
</p>
<h3><span class="mw-headline" id="An_attack_on_the_protocol">An attack on the protocol</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit&amp;section=5" title="Edit section: An attack on the protocol">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Unfortunately, this protocol is vulnerable to a <a href="/wiki/Man-in-the-middle_attack" title="Man-in-the-middle attack">man-in-the-middle attack</a>. If an impostor <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle I}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>I</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle I}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;" alt="I"/></span> can persuade <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7daff47fa58cdfd29dc333def748ff5fa4c923e3" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.743ex; height:2.176ex;" alt="A"/></span> to initiate a session with him, he can relay the messages to <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/47136aad860d145f75f3eed3022df827cee94d7a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.764ex; height:2.176ex;" alt="B"/></span> and convince <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/47136aad860d145f75f3eed3022df827cee94d7a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.764ex; height:2.176ex;" alt="B"/></span> that he is communicating with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7daff47fa58cdfd29dc333def748ff5fa4c923e3" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:1.743ex; height:2.176ex;" alt="A"/></span>.
</p><p>Ignoring the traffic to and from S, which is unchanged, the attack runs as follows:
</p><p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\rightarrow I:\{N_{A},A\}_{K_{PI}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>I</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>A</mi>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>I</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\rightarrow I:\{N_{A},A\}_{K_{PI}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c65b786622ce7c09cf6ef431170445aa66d02621" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:20.365ex; height:3.009ex;" alt="A\rightarrow I:\{N_{A},A\}_{{K_{{PI}}}}"/></span>
</p>
<dl><dd>A sends N<sub>A</sub> to I, who decrypts the message with K<sub>SI</sub></dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle I\rightarrow B:\{N_{A},A\}_{K_{PB}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>I</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>B</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>A</mi>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>B</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle I\rightarrow B:\{N_{A},A\}_{K_{PB}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7598e3cc30c70d8d4f822477f11de3b087c25cc3" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:20.726ex; height:3.009ex;" alt="I\rightarrow B:\{N_{A},A\}_{{K_{{PB}}}}"/></span>
</p>
<dl><dd>I relays the message to B, pretending that A is communicating</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B\rightarrow I:\{N_{A},N_{B}\}_{K_{PA}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>I</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>A</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B\rightarrow I:\{N_{A},N_{B}\}_{K_{PA}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1dcf71f70f6cce2e7735420e1b6dd9bb18232181" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:22.317ex; height:3.009ex;" alt="B\rightarrow I:\{N_{A},N_{B}\}_{{K_{{PA}}}}"/></span>
</p>
<dl><dd>B sends N<sub>B</sub></dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle I\rightarrow A:\{N_{A},N_{B}\}_{K_{PA}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>I</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>A</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>A</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle I\rightarrow A:\{N_{A},N_{B}\}_{K_{PA}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/94fcf4536d9cabe1a12be6dbbb444fbdeb4df39a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:22.296ex; height:3.009ex;" alt="I\rightarrow A:\{N_{A},N_{B}\}_{{K_{{PA}}}}"/></span>
</p>
<dl><dd>I relays it to A</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle A\rightarrow I:\{N_{B}\}_{K_{PI}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>A</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>I</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>I</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle A\rightarrow I:\{N_{B}\}_{K_{PI}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/88353d55b3e00d1991294b5c4c2a7a02d360497a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:17.603ex; height:3.009ex;" alt="A\rightarrow I:\{N_{B}\}_{{K_{{PI}}}}"/></span>
</p>
<dl><dd>A decrypts N<sub>B</sub> and confirms it to I, who learns it</dd></dl>
<p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle I\rightarrow B:\{N_{B}\}_{K_{PB}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>I</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>B</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>B</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle I\rightarrow B:\{N_{B}\}_{K_{PB}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8b056ac7d52ef0aa5ff9d11128b3ef8fe7904612" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:17.964ex; height:3.009ex;" alt="I\rightarrow B:\{N_{B}\}_{{K_{{PB}}}}"/></span>
</p>
<dl><dd>I re-encrypts N<sub>B</sub>, and convinces B that he's decrypted it</dd></dl>
<p>At the end of the attack, B falsely believes that A is communicating with him, and that N<sub>A</sub> and N<sub>B</sub> are known only to A and B.
</p>
<h3><span class="mw-headline" id="Fixing_the_man-in-the-middle_attack">Fixing the man-in-the-middle attack</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit&amp;section=6" title="Edit section: Fixing the man-in-the-middle attack">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The attack was first described in a 1995 paper by <a href="/wiki/Gavin_Lowe_(computer_scientist)" title="Gavin Lowe (computer scientist)">Gavin Lowe</a>.<sup id="cite_ref-lowe_4-0" class="reference"><a href="#cite_note-lowe-4">&#91;4&#93;</a></sup>
The paper also describes a fixed version of the scheme, referred to as the <b>Needham–Schroeder–Lowe protocol</b>. The fix involves the modification of message six to include the responder's identity, that is we replace:
</p><p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B\rightarrow A:\{N_{A},N_{B}\}_{K_{PA}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>A</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>A</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B\rightarrow A:\{N_{A},N_{B}\}_{K_{PA}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c4ee5a341e29812b2db22630e400659365848ea4" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:22.888ex; height:3.009ex;" alt="B\rightarrow A:\{N_{A},N_{B}\}_{{K_{{PA}}}}"/></span>
</p><p>with the fixed version:
</p><p><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle B\rightarrow A:\{N_{A},N_{B},B\}_{K_{PA}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>B</mi>
        <mo stretchy="false">&#x2192;<!-- → --></mo>
        <mi>A</mi>
        <mo>:</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>A</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>B</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>B</mi>
        <msub>
          <mo fence="false" stretchy="false">}</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>K</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>P</mi>
                <mi>A</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle B\rightarrow A:\{N_{A},N_{B},B\}_{K_{PA}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/be1feabc5ad2f5ff5baf3fce7a2cf3bafbd79c4a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; width:25.686ex; height:3.009ex;" alt="B\rightarrow A:\{N_{A},N_{B},B\}_{{K_{{PA}}}}"/></span>
</p><p>and the intruder cannot successfully replay the message because A is expecting a message containing the identity of I whereas the message will have identity of B.
</p>
<h2><span class="mw-headline" id="See_also">See also</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit&amp;section=7" title="Edit section: See also">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li><a href="/wiki/Kerberos_(protocol)" title="Kerberos (protocol)">Kerberos</a></li>
<li><a href="/wiki/Otway%E2%80%93Rees_protocol" title="Otway–Rees protocol">Otway–Rees protocol</a></li>
<li><a href="/wiki/Yahalom_(protocol)" title="Yahalom (protocol)">Yahalom</a></li>
<li><a href="/wiki/Wide_Mouth_Frog_protocol" title="Wide Mouth Frog protocol">Wide Mouth Frog protocol</a></li>
<li><a href="/wiki/Neuman%E2%80%93Stubblebine_protocol" title="Neuman–Stubblebine protocol">Neuman–Stubblebine protocol</a></li></ul>
<h2><span class="mw-headline" id="References">References</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit&amp;section=8" title="Edit section: References">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="reflist" style="list-style-type: decimal;">
<div class="mw-references-wrap"><ol class="references">
<li id="cite_note-needham-schroeder-1"><span class="mw-cite-backlink"><b><a href="#cite_ref-needham-schroeder_1-0">^</a></b></span> <span class="reference-text">
<cite class="citation journal">Needham, Roger; Schroeder, Michael (December 1978). "Using encryption for authentication in large networks of computers". <i>Communications of the ACM</i>. <b>21</b> (12): 993–999. <a href="/wiki/CiteSeerX" title="CiteSeerX">CiteSeerX</a>&#160;<span class="cs1-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="//citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.357.4298">10.1.1.357.4298</a></span>. <a href="/wiki/Digital_object_identifier" title="Digital object identifier">doi</a>:<a rel="nofollow" class="external text" href="//doi.org/10.1145%2F359657.359659">10.1145/359657.359659</a>.</cite><span title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Communications+of+the+ACM&amp;rft.atitle=Using+encryption+for+authentication+in+large+networks+of+computers.&amp;rft.volume=21&amp;rft.issue=12&amp;rft.pages=993-999&amp;rft.date=1978-12&amp;rft_id=%2F%2Fciteseerx.ist.psu.edu%2Fviewdoc%2Fsummary%3Fdoi%3D10.1.1.357.4298&amp;rft_id=info%3Adoi%2F10.1145%2F359657.359659&amp;rft.aulast=Needham&amp;rft.aufirst=Roger&amp;rft.au=Schroeder%2C+Michael&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ANeedham%E2%80%93Schroeder+protocol" class="Z3988"></span><style data-mw-deduplicate="TemplateStyles:r886058088">.mw-parser-output cite.citation{font-style:inherit}.mw-parser-output .citation q{quotes:"\"""\"""'""'"}.mw-parser-output .citation .cs1-lock-free a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/9px-Lock-green.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output .citation .cs1-lock-limited a,.mw-parser-output .citation .cs1-lock-registration a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/d/d6/Lock-gray-alt-2.svg/9px-Lock-gray-alt-2.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output .citation .cs1-lock-subscription a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/a/aa/Lock-red-alt-2.svg/9px-Lock-red-alt-2.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output .cs1-subscription,.mw-parser-output .cs1-registration{color:#555}.mw-parser-output .cs1-subscription span,.mw-parser-output .cs1-registration span{border-bottom:1px dotted;cursor:help}.mw-parser-output .cs1-ws-icon a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Wikisource-logo.svg/12px-Wikisource-logo.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output code.cs1-code{color:inherit;background:inherit;border:inherit;padding:inherit}.mw-parser-output .cs1-hidden-error{display:none;font-size:100%}.mw-parser-output .cs1-visible-error{font-size:100%}.mw-parser-output .cs1-maint{display:none;color:#33aa33;margin-left:0.3em}.mw-parser-output .cs1-subscription,.mw-parser-output .cs1-registration,.mw-parser-output .cs1-format{font-size:95%}.mw-parser-output .cs1-kern-left,.mw-parser-output .cs1-kern-wl-left{padding-left:0.2em}.mw-parser-output .cs1-kern-right,.mw-parser-output .cs1-kern-wl-right{padding-right:0.2em}</style></span>
</li>
<li id="cite_note-2"><span class="mw-cite-backlink"><b><a href="#cite_ref-2">^</a></b></span> <span class="reference-text"><cite class="citation journal"><a href="/wiki/Dorothy_E._Denning" title="Dorothy E. Denning">Denning, Dorothy E.</a>; Sacco, Giovanni Maria (1981). "Timestamps in key distribution protocols". <i>Communications of the ACM</i>. <b>24</b> (8): 533–535. <a href="/wiki/Digital_object_identifier" title="Digital object identifier">doi</a>:<a rel="nofollow" class="external text" href="//doi.org/10.1145%2F358722.358740">10.1145/358722.358740</a>.</cite><span title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Communications+of+the+ACM&amp;rft.atitle=Timestamps+in+key+distribution+protocols&amp;rft.volume=24&amp;rft.issue=8&amp;rft.pages=533-535&amp;rft.date=1981&amp;rft_id=info%3Adoi%2F10.1145%2F358722.358740&amp;rft.aulast=Denning&amp;rft.aufirst=Dorothy+E.&amp;rft.au=Sacco%2C+Giovanni+Maria&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ANeedham%E2%80%93Schroeder+protocol" class="Z3988"></span><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r886058088"/></span>
</li>
<li id="cite_note-3"><span class="mw-cite-backlink"><b><a href="#cite_ref-3">^</a></b></span> <span class="reference-text"><cite class="citation journal"><a href="/wiki/Roger_Needham" title="Roger Needham">Needham, R. M.</a>; <a href="/wiki/Michael_Schroeder" title="Michael Schroeder">Schroeder, M. D.</a> (1987). "Authentication revisited". <i>ACM SIGOPS Operating Systems Review</i>. <b>21</b> (1): 7. <a href="/wiki/Digital_object_identifier" title="Digital object identifier">doi</a>:<a rel="nofollow" class="external text" href="//doi.org/10.1145%2F24592.24593">10.1145/24592.24593</a>.</cite><span title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=ACM+SIGOPS+Operating+Systems+Review&amp;rft.atitle=Authentication+revisited&amp;rft.volume=21&amp;rft.issue=1&amp;rft.pages=7&amp;rft.date=1987&amp;rft_id=info%3Adoi%2F10.1145%2F24592.24593&amp;rft.aulast=Needham&amp;rft.aufirst=R.+M.&amp;rft.au=Schroeder%2C+M.+D.&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ANeedham%E2%80%93Schroeder+protocol" class="Z3988"></span><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r886058088"/></span>
</li>
<li id="cite_note-lowe-4"><span class="mw-cite-backlink"><b><a href="#cite_ref-lowe_4-0">^</a></b></span> <span class="reference-text">
<cite class="citation journal">Lowe, Gavin (November 1995). <a rel="nofollow" class="external text" href="http://web.comlab.ox.ac.uk/oucl/work/gavin.lowe/Security/Papers/NSPKP.ps">"An attack on the Needham-Schroeder public key authentication protocol"</a>. <i>Information Processing Letters</i>. <b>56</b> (3): 131–136. <a href="/wiki/CiteSeerX" title="CiteSeerX">CiteSeerX</a>&#160;<span class="cs1-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="//citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.394.6094">10.1.1.394.6094</a></span>. <a href="/wiki/Digital_object_identifier" title="Digital object identifier">doi</a>:<a rel="nofollow" class="external text" href="//doi.org/10.1016%2F0020-0190%2895%2900144-2">10.1016/0020-0190(95)00144-2</a><span class="reference-accessdate">. Retrieved <span class="nowrap">2008-04-17</span></span>.</cite><span title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Information+Processing+Letters&amp;rft.atitle=An+attack+on+the+Needham-Schroeder+public+key+authentication+protocol.&amp;rft.volume=56&amp;rft.issue=3&amp;rft.pages=131-136&amp;rft.date=1995-11&amp;rft_id=%2F%2Fciteseerx.ist.psu.edu%2Fviewdoc%2Fsummary%3Fdoi%3D10.1.1.394.6094&amp;rft_id=info%3Adoi%2F10.1016%2F0020-0190%2895%2900144-2&amp;rft.aulast=Lowe&amp;rft.aufirst=Gavin&amp;rft_id=http%3A%2F%2Fweb.comlab.ox.ac.uk%2Foucl%2Fwork%2Fgavin.lowe%2FSecurity%2FPapers%2FNSPKP.ps&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ANeedham%E2%80%93Schroeder+protocol" class="Z3988"></span><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r886058088"/></span>
</li>
</ol></div></div>
<h2><span class="mw-headline" id="External_links">External links</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit&amp;section=9" title="Edit section: External links">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table role="presentation" class="mbox-small plainlinks sistersitebox" style="background-color:#f9f9f9;border:1px solid #aaa;color:#000">
<tbody><tr>
<td class="mbox-image"><img alt="" src="//upload.wikimedia.org/wikipedia/en/thumb/4/4a/Commons-logo.svg/30px-Commons-logo.svg.png" decoding="async" width="30" height="40" class="noviewer" srcset="//upload.wikimedia.org/wikipedia/en/thumb/4/4a/Commons-logo.svg/45px-Commons-logo.svg.png 1.5x, //upload.wikimedia.org/wikipedia/en/thumb/4/4a/Commons-logo.svg/59px-Commons-logo.svg.png 2x" data-file-width="1024" data-file-height="1376" /></td>
<td class="mbox-text plainlist">Wikimedia Commons has media related to <i><b><a href="https://commons.wikimedia.org/wiki/Category:Needham-Schroeder_protocol" class="extiw" title="commons:Category:Needham-Schroeder protocol">Needham-Schroeder protocol</a></b></i>.</td></tr>
</tbody></table>
<ul><li><cite class="citation web">Roger Needham and Michael Schroeder (1978). <a rel="nofollow" class="external text" href="http://www.lsv.fr/Software/spore/nspk.html">"Needham-Schroeder Public Key"</a>. Laboratoire Spécification et Vérification.</cite><span title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=unknown&amp;rft.btitle=Needham-Schroeder+Public+Key&amp;rft.pub=Laboratoire+Sp%C3%A9cification+et+V%C3%A9rification&amp;rft.date=1978&amp;rft_id=http%3A%2F%2Fwww.lsv.fr%2FSoftware%2Fspore%2Fnspk.html&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ANeedham%E2%80%93Schroeder+protocol" class="Z3988"></span><span class="cs1-maint citation-comment">CS1 maint: uses authors parameter (<a href="/wiki/Category:CS1_maint:_uses_authors_parameter" title="Category:CS1 maint: uses authors parameter">link</a>)</span><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r886058088"/></li></ul>
<ul><li><cite class="citation web">Roger Needham and Michael Schroeder (1978). <a rel="nofollow" class="external text" href="http://www.lsv.fr/Software/spore/nssk.html">"Needham Schroeder Symmetric Key"</a>. Laboratoire Spécification et Vérification.</cite><span title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=unknown&amp;rft.btitle=Needham+Schroeder+Symmetric+Key&amp;rft.pub=Laboratoire+Sp%C3%A9cification+et+V%C3%A9rification&amp;rft.date=1978&amp;rft_id=http%3A%2F%2Fwww.lsv.fr%2FSoftware%2Fspore%2Fnssk.html&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ANeedham%E2%80%93Schroeder+protocol" class="Z3988"></span><span class="cs1-maint citation-comment">CS1 maint: uses authors parameter (<a href="/wiki/Category:CS1_maint:_uses_authors_parameter" title="Category:CS1 maint: uses authors parameter">link</a>)</span><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r886058088"/></li></ul>
<ul><li><cite class="citation web">Gavin Lowe (1995). <a rel="nofollow" class="external text" href="http://www.lsv.fr/Software/spore/nspkLowe.html">"Lowe's fixed version of Needham-Schroder Public Key"</a>. Laboratoire Spécification et Vérification.</cite><span title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=unknown&amp;rft.btitle=Lowe%27s+fixed+version+of+Needham-Schroder+Public+Key&amp;rft.pub=Laboratoire+Sp%C3%A9cification+et+V%C3%A9rification&amp;rft.date=1995&amp;rft_id=http%3A%2F%2Fwww.lsv.fr%2FSoftware%2Fspore%2FnspkLowe.html&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ANeedham%E2%80%93Schroeder+protocol" class="Z3988"></span><span class="cs1-maint citation-comment">CS1 maint: uses authors parameter (<a href="/wiki/Category:CS1_maint:_uses_authors_parameter" title="Category:CS1 maint: uses authors parameter">link</a>)</span><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r886058088"/></li></ul>
<!-- 
NewPP limit report
Parsed by mw1272
Cached time: 20190925022642
Cache expiry: 2592000
Dynamic content: false
Complications: [vary‐revision‐sha1]
CPU time usage: 0.264 seconds
Real time usage: 0.402 seconds
Preprocessor visited node count: 704/1000000
Preprocessor generated node count: 0/1500000
Post‐expand include size: 15986/2097152 bytes
Template argument size: 410/2097152 bytes
Highest expansion depth: 15/40
Expensive parser function count: 2/500
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 19962/5000000 bytes
Number of Wikibase entities loaded: 2/400
Lua time usage: 0.134/10.000 seconds
Lua memory usage: 3.54 MB/50 MB
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  271.735      1 -total
 72.56%  197.166      1 Template:Reflist
 64.72%  175.857      4 Template:Cite_journal
 22.03%   59.852      1 Template:Commonscat
 18.08%   49.143      1 Template:Commons
 16.93%   46.006      1 Template:Sister_project
 15.61%   42.426      1 Template:Side_box
 11.82%   32.108      2 Template:If_then_show
  5.26%   14.284      3 Template:Cite_web
  1.16%    3.147      1 Template:Main_other
-->

<!-- Saved in parser cache with key enwiki:pcache:idhash:432989-0!canonical!math=5 and timestamp 20190925022641 and revision id 886382140
 -->
</div><noscript><img src="//en.wikipedia.org/wiki/Special:CentralAutoLogin/start?type=1x1" alt="" title="" width="1" height="1" style="border: none; position: absolute;" /></noscript></div>
		
		<div class="printfooter">Retrieved from "<a dir="ltr" href="https://en.wikipedia.org/w/index.php?title=Needham–Schroeder_protocol&amp;oldid=886382140">https://en.wikipedia.org/w/index.php?title=Needham–Schroeder_protocol&amp;oldid=886382140</a>"</div>
		
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Help:Category" title="Help:Category">Categories</a>: <ul><li><a href="/wiki/Category:Authentication_protocols" title="Category:Authentication protocols">Authentication protocols</a></li><li><a href="/wiki/Category:Key_transport_protocols" title="Category:Key transport protocols">Key transport protocols</a></li><li><a href="/wiki/Category:Symmetric-key_cryptography" title="Category:Symmetric-key cryptography">Symmetric-key cryptography</a></li><li><a href="/wiki/Category:Computer_access_control_protocols" title="Category:Computer access control protocols">Computer access control protocols</a></li></ul></div><div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul><li><a href="/wiki/Category:Commons_category_link_from_Wikidata" title="Category:Commons category link from Wikidata">Commons category link from Wikidata</a></li><li><a href="/wiki/Category:CS1_maint:_uses_authors_parameter" title="Category:CS1 maint: uses authors parameter">CS1 maint: uses authors parameter</a></li></ul></div></div>
		<div class="visualClear"></div>
		
	</div>
</div>
<div id='mw-data-after-content'>
	<div class="read-more-container"></div>
</div>


		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-anonuserpage">Not logged in</li><li id="pt-anontalk"><a href="/wiki/Special:MyTalk" title="Discussion about edits from this IP address [n]" accesskey="n">Talk</a></li><li id="pt-anoncontribs"><a href="/wiki/Special:MyContributions" title="A list of edits made from this IP address [y]" accesskey="y">Contributions</a></li><li id="pt-createaccount"><a href="/w/index.php?title=Special:CreateAccount&amp;returnto=Needham%E2%80%93Schroeder+protocol" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Needham%E2%80%93Schroeder+protocol" title="You&#039;re encouraged to log in; however, it&#039;s not mandatory. [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="/wiki/Needham%E2%80%93Schroeder_protocol" title="View the content page [c]" accesskey="c">Article</a></span></li><li id="ca-talk"><span><a href="/wiki/Talk:Needham%E2%80%93Schroeder_protocol" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Talk</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<ul class="menu">
													</ul>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="/wiki/Needham%E2%80%93Schroeder_protocol">Read</a></span></li><li id="ca-edit" class="collapsible"><span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=edit" title="Edit this page [e]" accesskey="e">Edit</a></span></li><li id="ca-history" class="collapsible"><span><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<ul class="menu">
													</ul>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="/w/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Wikipedia" title="Search Wikipedia [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search Wikipedia for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="/wiki/Main_Page" title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li><li id="n-contents"><a href="/wiki/Portal:Contents" title="Guides to browsing Wikipedia">Contents</a></li><li id="n-featuredcontent"><a href="/wiki/Portal:Featured_content" title="Featured content – the best of Wikipedia">Featured content</a></li><li id="n-currentevents"><a href="/wiki/Portal:Current_events" title="Find background information on current events">Current events</a></li><li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random article [x]" accesskey="x">Random article</a></li><li id="n-sitesupport"><a href="https://donate.wikimedia.org/wiki/Special:FundraiserRedirector?utm_source=donate&amp;utm_medium=sidebar&amp;utm_campaign=C13_en.wikipedia.org&amp;uselang=en" title="Support us">Donate to Wikipedia</a></li><li id="n-shoplink"><a href="//shop.wikimedia.org" title="Visit the Wikipedia store">Wikipedia store</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-interaction" aria-labelledby="p-interaction-label">
			<h3 id="p-interaction-label">Interaction</h3>
			<div class="body">
								<ul>
					<li id="n-help"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia">Help</a></li><li id="n-aboutsite"><a href="/wiki/Wikipedia:About" title="Find out about Wikipedia">About Wikipedia</a></li><li id="n-portal"><a href="/wiki/Wikipedia:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li><li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-contactpage"><a href="//en.wikipedia.org/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia">Contact page</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Tools</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Needham%E2%80%93Schroeder_protocol" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Needham%E2%80%93Schroeder_protocol" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-upload"><a href="/wiki/Wikipedia:File_Upload_Wizard" title="Upload files [u]" accesskey="u">Upload file</a></li><li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-permalink"><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;oldid=886382140" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;action=info" title="More information about this page">Page information</a></li><li id="t-wikibase"><a href="https://www.wikidata.org/wiki/Special:EntityPage/Q934370" title="Link to connected data repository item [g]" accesskey="g">Wikidata item</a></li><li id="t-cite"><a href="/w/index.php?title=Special:CiteThisPage&amp;page=Needham%E2%80%93Schroeder_protocol&amp;id=886382140" title="Information on how to cite this page">Cite this page</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-wikibase-otherprojects" aria-labelledby="p-wikibase-otherprojects-label">
			<h3 id="p-wikibase-otherprojects-label">In other projects</h3>
			<div class="body">
								<ul>
					<li class="wb-otherproject-link wb-otherproject-commons"><a href="https://commons.wikimedia.org/wiki/Category:Needham-Schroeder_protocol" hreflang="en">Wikimedia Commons</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-coll-print_export" aria-labelledby="p-coll-print_export-label">
			<h3 id="p-coll-print_export-label">Print/export</h3>
			<div class="body">
								<ul>
					<li id="coll-create_a_book"><a href="/w/index.php?title=Special:Book&amp;bookcmd=book_creator&amp;referer=Needham%E2%80%93Schroeder+protocol">Create a book</a></li><li id="coll-download-as-rl"><a href="/w/index.php?title=Special:ElectronPdf&amp;page=Needham%E2%80%93Schroeder+protocol&amp;action=show-download-screen">Download as PDF</a></li><li id="t-print"><a href="/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-lang" aria-labelledby="p-lang-label">
			<h3 id="p-lang-label">Languages</h3>
			<div class="body">
								<ul>
					<li class="interlanguage-link interwiki-de"><a href="https://de.wikipedia.org/wiki/Needham-Schroeder-Protokoll" title="Needham-Schroeder-Protokoll – German" lang="de" hreflang="de" class="interlanguage-link-target">Deutsch</a></li><li class="interlanguage-link interwiki-es"><a href="https://es.wikipedia.org/wiki/Protocolo_de_Needham-Schroeder" title="Protocolo de Needham-Schroeder – Spanish" lang="es" hreflang="es" class="interlanguage-link-target">Español</a></li><li class="interlanguage-link interwiki-fr"><a href="https://fr.wikipedia.org/wiki/Protocole_de_Needham-Schroeder" title="Protocole de Needham-Schroeder – French" lang="fr" hreflang="fr" class="interlanguage-link-target">Français</a></li><li class="interlanguage-link interwiki-it"><a href="https://it.wikipedia.org/wiki/Protocollo_di_Needham-Schroeder" title="Protocollo di Needham-Schroeder – Italian" lang="it" hreflang="it" class="interlanguage-link-target">Italiano</a></li><li class="interlanguage-link interwiki-nl"><a href="https://nl.wikipedia.org/wiki/Needham-Schroeder-protocol" title="Needham-Schroeder-protocol – Dutch" lang="nl" hreflang="nl" class="interlanguage-link-target">Nederlands</a></li><li class="interlanguage-link interwiki-pt"><a href="https://pt.wikipedia.org/wiki/Protocolo_de_Needham%E2%80%93Schroeder" title="Protocolo de Needham–Schroeder – Portuguese" lang="pt" hreflang="pt" class="interlanguage-link-target">Português</a></li><li class="interlanguage-link interwiki-ru badge-Q17437798 badge-goodarticle" title="good article"><a href="https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB_%D0%9D%D0%B8%D0%B4%D1%85%D0%B5%D0%BC%D0%B0_%E2%80%94_%D0%A8%D1%80%D1%91%D0%B4%D0%B5%D1%80%D0%B0" title="Протокол Нидхема — Шрёдера – Russian" lang="ru" hreflang="ru" class="interlanguage-link-target">Русский</a></li><li class="interlanguage-link interwiki-simple"><a href="https://simple.wikipedia.org/wiki/Needham-Schroeder_protocol" title="Needham-Schroeder protocol – Simple English" lang="en-simple" hreflang="en-simple" class="interlanguage-link-target">Simple English</a></li><li class="interlanguage-link interwiki-uk"><a href="https://uk.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB_%D0%9D%D1%96%D0%B4%D0%B3%D0%B5%D0%BC%D0%B0_%E2%80%94_%D0%A8%D1%80%D0%B5%D0%B4%D0%B5%D1%80%D0%B0" title="Протокол Нідгема — Шредера – Ukrainian" lang="uk" hreflang="uk" class="interlanguage-link-target">Українська</a></li><li class="interlanguage-link interwiki-vi"><a href="https://vi.wikipedia.org/wiki/Giao_th%E1%BB%A9c_Needham-Schroeder" title="Giao thức Needham-Schroeder – Vietnamese" lang="vi" hreflang="vi" class="interlanguage-link-target">Tiếng Việt</a></li>				</ul>
				<div class="after-portlet after-portlet-lang"><span class="wb-langlinks-edit wb-langlinks-link"><a href="https://www.wikidata.org/wiki/Special:EntityPage/Q934370#sitelinks-wikipedia" title="Edit interlanguage links" class="wbc-editpage">Edit links</a></span></div>			</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 5 March 2019, at 23:05<span class="anonymous-show">&#160;(UTC)</span>.</li>
								<li id="footer-info-copyright">Text is available under the <a rel="license" href="//en.wikipedia.org/wiki/Wikipedia:Text_of_Creative_Commons_Attribution-ShareAlike_3.0_Unported_License">Creative Commons Attribution-ShareAlike License</a><a rel="license" href="//creativecommons.org/licenses/by-sa/3.0/" style="display:none;"></a>;
additional terms may apply.  By using this site, you agree to the <a href="//foundation.wikimedia.org/wiki/Terms_of_Use">Terms of Use</a> and <a href="//foundation.wikimedia.org/wiki/Privacy_policy">Privacy Policy</a>. Wikipedia® is a registered trademark of the <a href="//www.wikimediafoundation.org/">Wikimedia Foundation, Inc.</a>, a non-profit organization.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="https://foundation.wikimedia.org/wiki/Privacy_policy" class="extiw" title="wmf:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="/wiki/Wikipedia:About" title="Wikipedia:About">About Wikipedia</a></li>
								<li id="footer-places-disclaimer"><a href="/wiki/Wikipedia:General_disclaimer" title="Wikipedia:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-contact"><a href="//en.wikipedia.org/wiki/Wikipedia:Contact_us">Contact Wikipedia</a></li>
								<li id="footer-places-developers"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/How_to_contribute">Developers</a></li>
								<li id="footer-places-cookiestatement"><a href="https://foundation.wikimedia.org/wiki/Cookie_statement">Cookie statement</a></li>
								<li id="footer-places-mobileview"><a href="//en.m.wikipedia.org/w/index.php?title=Needham%E2%80%93Schroeder_protocol&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="https://wikimediafoundation.org/"><img src="/static/images/wikimedia-button.png" srcset="/static/images/wikimedia-button-1.5x.png 1.5x, /static/images/wikimedia-button-2x.png 2x" width="88" height="31" alt="Wikimedia Foundation"/></a>					</li>
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="/static/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/static/images/poweredby_mediawiki_132x47.png 1.5x, /static/images/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.264","walltime":"0.402","ppvisitednodes":{"value":704,"limit":1000000},"ppgeneratednodes":{"value":0,"limit":1500000},"postexpandincludesize":{"value":15986,"limit":2097152},"templateargumentsize":{"value":410,"limit":2097152},"expansiondepth":{"value":15,"limit":40},"expensivefunctioncount":{"value":2,"limit":500},"unstrip-depth":{"value":1,"limit":20},"unstrip-size":{"value":19962,"limit":5000000},"entityaccesscount":{"value":2,"limit":400},"timingprofile":["100.00%  271.735      1 -total"," 72.56%  197.166      1 Template:Reflist"," 64.72%  175.857      4 Template:Cite_journal"," 22.03%   59.852      1 Template:Commonscat"," 18.08%   49.143      1 Template:Commons"," 16.93%   46.006      1 Template:Sister_project"," 15.61%   42.426      1 Template:Side_box"," 11.82%   32.108      2 Template:If_then_show","  5.26%   14.284      3 Template:Cite_web","  1.16%    3.147      1 Template:Main_other"]},"scribunto":{"limitreport-timeusage":{"value":"0.134","limit":"10.000"},"limitreport-memusage":{"value":3715983,"limit":52428800}},"cachereport":{"origin":"mw1272","timestamp":"20190925022642","ttl":2592000,"transientcontent":false}}});});</script>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Article","name":"Needham\u2013Schroeder protocol","url":"https:\/\/en.wikipedia.org\/wiki\/Needham%E2%80%93Schroeder_protocol","sameAs":"http:\/\/www.wikidata.org\/entity\/Q934370","mainEntity":"http:\/\/www.wikidata.org\/entity\/Q934370","author":{"@type":"Organization","name":"Contributors to Wikimedia projects"},"publisher":{"@type":"Organization","name":"Wikimedia Foundation, Inc.","logo":{"@type":"ImageObject","url":"https:\/\/www.wikimedia.org\/static\/images\/wmf-hor-googpub.png"}},"datePublished":"2004-01-16T19:08:32Z","dateModified":"2019-03-05T23:05:29Z","image":"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/4\/4b\/Symetric_Needham-Schroeder-Protocol_%E2%80%93_linear.svg","headline":"cryptographic protocol"}</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":97,"wgHostname":"mw1272"});});</script>
</body>
</html>
